{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar Mejorado -->
        <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block sidebar collapse shadow-lg" 
             style="background: linear-gradient(180deg, #1E1E2D 0%, #252540 100%); color: white; position: sticky; top: 0; height: 100vh; overflow-y: auto;">
            <div class="position-sticky pt-3">
                <!-- User Info Card -->
                <div class="px-4 py-3 text-center border-bottom border-secondary mb-2">
                    <div class="d-flex align-items-center justify-content-center mb-2">
                        <div class="rounded-circle p-2" style="background: linear-gradient(135deg, #703D80, #5A3166);">
                            <i class="fas fa-user fa-lg text-light"></i>
                        </div>
                    </div>
                    <h6 class="mt-1 mb-1 fw-semibold" style="font-size: 0.95rem;">{{ user.get_full_name }}</h6>
                    <span class="badge" style="background-color: #703D80; font-size: 0.7rem; padding: 0.3rem 0.6rem;">Staff</span>
                    
                    <!-- Logout Button Compacto Integrado -->
                    <div class="mt-3">
                        <form method="post" action="{% url 'logout' %}" class="w-100">
                            {% csrf_token %}
                            <button type="submit" 
                                    class="btn btn-logout-compact w-100 py-2 d-flex align-items-center justify-content-center"
                                    style="background: rgba(220, 53, 69, 0.12); color: #ff6b7a; border: 1px solid rgba(220, 53, 69, 0.25); border-radius: 8px; font-weight: 500; transition: all 0.3s ease; font-size: 0.85rem;">
                                <i class="fas fa-sign-out-alt fa-fw me-2" style="font-size: 0.9rem;"></i>
                                <span>Cerrar Sesi贸n</span>
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Navigation Menu -->
                <ul class="nav flex-column px-3 py-2">
                    <li class="nav-item mb-2">
                        <a class="nav-link py-2 px-3 d-flex align-items-center {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" 
                           href="{% url 'dashboard' %}" 
                           style="color: white; border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.9rem;">
                            <i class="fas fa-home fa-fw me-3" style="font-size: 1.05rem;"></i> 
                            <span>Panel Principal</span>
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link py-2 px-3 d-flex align-items-center {% if request.resolver_match.url_name == 'staff_availability' %}active{% endif %}" 
                           href="{% url 'staff_availability' %}" 
                           style="color: white; border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.9rem;">
                            <i class="fas fa-calendar-alt fa-fw me-3" style="font-size: 1.05rem;"></i> 
                            <span>Disponibilidad</span>
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link py-2 px-3 d-flex align-items-center {% if request.resolver_match.url_name == 'appointments_crud' %}active{% endif %}" 
                           href="{% url 'appointments_crud' %}" 
                           style="color: white; border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.9rem;">
                            <i class="fas fa-calendar-check fa-fw me-3" style="font-size: 1.05rem;"></i> 
                            <span>Gesti贸n de Citas</span>
                        </a>
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link py-2 px-3 d-flex align-items-center {% if request.resolver_match.url_name == 'staff_profile' %}active{% endif %}" 
                           href="{% url 'staff_profile' %}" 
                           style="color: white; border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.9rem;">
                            <i class="fas fa-user-cog fa-fw me-3" style="font-size: 1.05rem;"></i> 
                            <span>Mi Perfil</span>
                        </a>
                    </li>
                    
                    <!-- Gesti贸n de Usuarios (solo superadmin) -->
                    {% if user.is_superuser %}
                    <li class="nav-item mt-3 mb-2">
                        <hr class="border-secondary mx-3">
                    </li>
                    <li class="nav-item mb-2">
                        <a class="nav-link py-2 px-3 d-flex align-items-center {% if request.resolver_match.url_name == 'user_management' %}active{% endif %}" 
                           href="{% url 'user_management' %}" 
                           style="color: white; border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.9rem;">
                            <i class="fas fa-users-cog fa-fw me-3" style="font-size: 1.05rem;"></i> 
                            <span>Gesti贸n de Usuarios</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4" style="background-color: #f8f9fa; min-height: 100vh;">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-4 pb-3 mb-4 border-bottom">
                <h4 class="mb-1 fw-bold" style="color: #1a1a2e; font-size: 1.75rem;">{% block page_title %}{% endblock %}</h4>
            </div>
            {% block admin_content %}{% endblock %}
        </main>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Estilos Modernos del Sidebar */
    .nav-link {
        position: relative;
        overflow: hidden;
    }
    
    .nav-link::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 3px;
        background: linear-gradient(180deg, #703D80, #F3BF4D);
        transform: scaleY(0);
        transition: transform 0.3s ease;
    }
    
    .nav-link:hover::before,
    .nav-link.active::before {
        transform: scaleY(1);
    }
    
    .nav-link:hover, .nav-link.active {
        background: linear-gradient(90deg, rgba(112, 61, 128, 0.15), transparent) !important;
        color: #F3BF4D !important;
        transform: translateX(3px);
    }
    
    .nav-link i {
        transition: transform 0.3s ease;
    }
    
    .nav-link:hover i {
        transform: scale(1.08);
    }

    /* Logout Button Compact Styles */
    .btn-logout-compact {
        text-decoration: none !important;
        cursor: pointer;
    }

    .btn-logout-compact:hover {
        background: rgba(220, 53, 69, 0.2) !important;
        border-color: rgba(220, 53, 69, 0.4) !important;
        color: #ff8a94 !important;
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(220, 53, 69, 0.25);
    }

    .btn-logout-compact:active {
        transform: translateY(0);
    }

    .btn-logout-compact:focus {
        outline: none;
        box-shadow: 0 0 0 0.15rem rgba(220, 53, 69, 0.2);
    }
    
    /* Scrollbar personalizado */
    #sidebar::-webkit-scrollbar {
        width: 5px;
    }
    
    #sidebar::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
    }
    
    #sidebar::-webkit-scrollbar-thumb {
        background: rgba(112, 61, 128, 0.4);
        border-radius: 10px;
    }
    
    #sidebar::-webkit-scrollbar-thumb:hover {
        background: rgba(112, 61, 128, 0.6);
    }
    
    /* Mejoras generales */
    .card {
        border: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        border-radius: 12px;
        transition: all 0.3s ease;
    }
    
    .card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        transform: translateY(-2px);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        #sidebar {
            position: relative !important;
            height: auto !important;
        }
    }
</style>
{% endblock %}